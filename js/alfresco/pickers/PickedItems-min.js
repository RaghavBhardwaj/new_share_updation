define(["dojo/_base/declare","alfresco/documentlibrary/views/AlfDocumentListView","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dijit/registry"],function(g,m,c,j,d,l,a){return g([m],{i18nScope:"alfresco.pickers.PickedItems",i18nRequirements:[{i18nFile:"./i18n/PickedItems.properties"}],postCreate:function h(){this.removeUploadDragAndDrop(this.domNode);this.alfSubscribe("ALF_ITEM_SELECTED",c.hitch(this,"addPickedItem"));this.alfSubscribe("ALF_ITEM_REMOVED",c.hitch(this,"removePickedItem"));this.currentData={items:(this.value!=null)?this.value:[]};this.renderView()},clearData:function i(){},itemKey:"nodeRef",addPickedItem:function f(p){if(p.item!=null){var o=c.getObject(this.itemKey,false,p.item);if(o==null){this.alfLog("warn","The supplied item does not have a key attribute as expected",p.item,this)}else{var n=this.findPickedItem(o);if(n==null){this.currentData.items.push(p.item);this.renderView()}else{this.alfLog("log","Item is already picked - it will not be added a second time",p.item,this)}}}},removePickedItem:function b(n){var o=c.getObject(this.itemKey,false,n.item);if(o==null){this.alfLog("warn","The supplied item does not have a key attribute as expected",n.item,this)}else{this.currentData.items=j.filter(this.currentData.items,function(r,p){var q=c.getObject(this.itemKey,false,r);return q!=o},this);this.renderView();this.alfPublish("ALF_ITEMS_SELECTED",{pickedItems:this.currentData.items})}},findPickedItem:function e(n){var p=null;var o=j.filter(this.currentData.items,function(s,q){var r=c.getObject(this.itemKey,false,s);return r==n},this);if(o.length>0){p=o[0]}return p},setPickedItems:function k(n){if(n!=null){this.currentData.items=n}else{this.alfLog("warn","No items supplied to 'setPickedItems' function",n,this)}this.renderView()},widgets:[{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{width:"20px",widgets:[{name:"alfresco/renderers/FileType",config:{size:"small",renderAsLink:false}}]}},{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/Property",config:{propertyToRender:"node.properties.cm:name",renderAsLink:false}}]}},{name:"alfresco/documentlibrary/views/layouts/Cell",config:{width:"20px",widgets:[{name:"alfresco/renderers/PublishAction",config:{iconClass:"delete-16",publishTopic:"ALF_ITEM_REMOVED"}}]}}]}}]})});