define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/SingleItemPicker.html","alfresco/core/Core","alfresco/core/CoreWidgetProcessing","dojo/_base/lang","dojo/_base/array"],function(f,i,m,k,d,a,c,h){return f([i,m,d,a],{cssRequirements:[{cssFile:"./css/SingleItemPicker.css"}],templateString:k,postCreate:function b(){if(this.requestItemsTopic!=null){var n=this.generateUuid();var q=n+"ALF_SINGLE_PICKER_ITEMS_REQUEST";var o=q+"_SUCCESS";var p=q+"_FAILURE";this.alfSubscribe(o,c.hitch(this,"onItemsLoadSuccess"),true);this.alfSubscribe(p,c.hitch(this,"onItemsLoadFailure"),true);this.alfPublish(this.requestItemsTopic,{alfResponseTopic:q},true)}},onItemsLoadSuccess:function l(p){this.alfLog("log","Items loaded",p);if(p==null||p.response==null){this.alfLog("warn","The response for a request for SingleItemPicker items did not contain a 'response' attribute",p,this)}else{var o=[];h.forEach(p.response,c.hitch(this,"addItemWidgetConfig",o));var n=[{name:"alfresco/menus/AlfVerticalMenuBar",config:{widgets:o}}];this.processWidgets(n,this.itemsNode)}},addItemWidgetConfig:function g(q,r,p){var o=r.node.substring(r.node.indexOf("workspace"));var n={name:"alfresco/menus/AlfMenuBarItem",config:{label:r.title,publishTopic:"ALF_ADD_PICKER",publishPayload:{currentPickerDepth:this.currentPickerDepth,picker:{name:"alfresco/pickers/DocumentListPicker",config:{libraryRoot:o,nodeRef:o,path:"/"}}}}};q.push(n)},onItemsLoadFailure:function e(n){this.alfLog("error","An error occurred trying to retrieve the items to display",n,this)},onItemSelected:function j(){}})});