define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","alfresco/renderers/_JsNodeMixin","dojo/text!./templates/Toggle.html","alfresco/core/Core","alfresco/renderers/_ItemLinkMixin","dijit/_OnDijitClickMixin","dojo/_base/lang","dojo/dom-class"],function(u,b,p,d,v,l,k,m,x,f){return u([b,p,d,l,k,m],{i18nRequirements:[{i18nFile:"./i18n/Toggle.properties"}],cssRequirements:[{cssFile:"./css/Toggle.css"}],templateString:v,onLabel:"toggle.on.label",offLabel:"toggle.off.label",onTooltip:"toggle.on.tooltip",offTooltip:"toggle.off.tooltip",toggleClass:"",toggleOnTopic:null,toggleOnSuccessTopic:null,toggleOnFailureTopic:null,toggleOffTopic:null,toggleOffSuccessTopic:null,toggleOffFailureTopic:null,postMixInProperties:function w(){this.onLabel=this.message(this.onLabel);this.offLabel=this.message(this.offLabel);this.onTooltip=this.message(this.onTooltip);this.offTooltip=this.message(this.offTooltip);if(this.toggleOnTopic!=null){if(this.toggleOnSuccessTopic==null){this.toggleOnSuccessTopic=this.toggleOnTopic+"_SUCCESS"}if(this.toggleOnFailureTopic==null){this.toggleOnFailureTopic=this.toggleOnTopic+"_FAILURE"}}if(this.toggleOffTopic!=null){if(this.toggleOffSuccessTopic==null){this.toggleOffSuccessTopic=this.toggleOffTopic+"_SUCCESS"}if(this.toggleOffFailureTopic==null){this.toggleOffFailureTopic=this.toggleOffTopic+"_FAILURE"}}},isToggleOn:null,getInitialState:function g(){return false},postCreate:function s(){this.isToggleOn=this.getInitialState();if(this.isToggleOn){f.remove(this.onNode,"hidden")}else{f.remove(this.offNode,"hidden")}if(this.toggleOnTopic!=null){this.alfSubscribe(this.toggleOnSuccessTopic,x.hitch(this,"checkApplicable",this.onToggleOnSuccess));this.alfSubscribe(this.toggleOnFailureTopic,x.hitch(this,"checkApplicable",this.onToggleOnFailure))}if(this.toggleOffTopic!=null){this.alfSubscribe(this.toggleOffSuccessTopic,x.hitch(this,"checkApplicable",this.onToggleOffSuccess));this.alfSubscribe(this.toggleOffFailureTopic,x.hitch(this,"checkApplicable",this.onToggleOffFailure))}},onClick:function n(){if(this.isToggleOn){this.renderToggledOff();this.toggledOff()}else{this.renderToggledOn();this.toggledOn()}},renderToggledOn:function o(){f.add(this.warningNode,"hidden");f.add(this.offNode,"hidden");f.remove(this.processingNode,"hidden")},renderToggledOff:function j(){f.add(this.warningNode,"hidden");f.add(this.onNode,"hidden");f.remove(this.processingNode,"hidden")},toggledOn:function c(){this.alfPublish(this.toggleOnTopic,{node:this.currentItem})},toggledOff:function a(){this.alfPublish(this.toggleOffTopic,{node:this.currentItem})},checkApplicable:function r(y,z){if(this.relatesToMe(z)){y.call(this,z)}},relatesToMe:function q(z){var A=false;try{A=(z.requestConfig.data.node.nodeRef==this.currentItem.nodeRef)}catch(y){this.alfLog("error","Unexpected data structures",y,z,this)}return A},onToggleOnSuccess:function e(y){this.isToggleOn=true;f.add(this.processingNode,"hidden");f.remove(this.onNode,"hidden")},onToggleOnFailure:function h(y){this.isToggleOn=false;f.add(this.processingNode,"hidden");f.remove(this.offNode,"hidden");f.remove(this.warningNode,"hidden")},onToggleOffSuccess:function t(y){this.isToggleOn=false;f.add(this.processingNode,"hidden");f.remove(this.offNode,"hidden")},onToggleOffFailure:function i(y){this.isToggleOn=true;f.add(this.processingNode,"hidden");f.remove(this.onNode,"hidden");f.remove(this.warningNode,"hidden")}})});