define(["dojo/_base/declare","alfresco/core/Core","service/constants/Default","alfresco/core/UrlUtils","alfresco/core/PathUtils","dojo/_base/lang","dojo/on","dojo/_base/event","dojo/query","dojo/NodeList","dojo/NodeList-manipulate"],function(l,g,i,k,n,f,p,d,q,a,h){return l([g,k,n],{createItemLink:function m(s){if(s==null){this.alfLog("warn","A request has been made to create a link for an item, but no DOM node has been provided",this)}else{var t=this.generateFileFolderLink();var r;if(typeof t.type=="undefined"||t.type==null||t.type==""||t.type=="SHARE_PAGE_RELATIVE"){r=i.URL_PAGECONTEXT+t.url}else{if(t.type=="CONTEXT_RELATIVE"){r=i.URL_CONTEXT+t.url}else{if(t.type=="FULL_PATH"){r=t.url}else{r=window.location.pathname+"#"+t.url}}}p(s,"click",f.hitch(this,"onItemLinkClick",t));dojo.query(s).wrap("<a class='alfresco-menus-_AlfMenuItemMixin' href='"+r+"'></a>")}},linkClickTopic:"ALF_NAVIGATE_TO_PAGE",onItemLinkClick:function c(s,r){d.stop(r);this.alfLog("log","Item link clicked: ",s,this);this.alfPublish(this.linkClickTopic,s)},generateFileFolderLink:function j(){var t={url:"",type:"FULL_PATH",target:"CURRENT"};if(this.currentItem!=null&&this.currentItem.node){var r=this.currentItem.jsNode;if(r.isLink&&this.currentItem.location.site){if(r.isContainer){t.url=$siteURL("documentlibrary?path="+encodeURIComponent(this.currentItem.location.path),{site:this.currentItem.location.site.name})}else{t.url=this.getActionUrls(this.currentItem,this.currentItem.location.site.name).documentDetailsUrl}}else{if(r.isContainer){if(this.currentItem.parent.isContainer){t.type="HASH";t.url=this.generatePathMarkup(this.currentItem.location)}else{if(this.currentItem.location.path==="/"){t.type="HASH";t.url=this.generateFilterMarkup({filterId:"path",filterData:$combine(this.currentItem.location.path,"")})}else{t.type="HASH";t.url="#"}}}else{var s=this.getActionUrls(this.currentItem);if(r.isLink&&r.linkedNode.isContainer){t.url=actionUrls.folderDetailsUrl}else{t=this.getDetailsPayload()}}}}t.item=this.currentItem;return t},customDetailsURL:null,getDetailsPayload:function o(){var s={url:"",type:"FULL_PATH",target:"CURRENT"};if(this.customDetailsURL==null){var r=this.getActionUrls(this.currentItem);s.url=actionUrls.documentDetailsUrl}else{s.url=this.customDetailsURL;if(f.exists("currentItem.jsNode.nodeRef.uri",this)){s.url+="/"+this.currentItem.jsNode.nodeRef.uri}}return s},generateFilterMarkup:function e(r){var s=Alfresco.util.cleanBubblingObject(r);return YAHOO.lang.substitute("filter={filterId}|{filterData}|{filterDisplay}",s,function(u,v,t){return typeof v==="undefined"?"":window.escape(v)})},generatePathMarkup:function b(r){return this.generateFilterMarkup({filterId:"path",filterData:this.combinePaths(r.path,r.file)})}})});