define(["alfresco/core/ProcessWidgets","dojo/_base/declare","dojo/text!./templates/HorizontalWidgets.html","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-style","dojo/dom-geometry","dojo/on","alfresco/core/ObjectTypeUtils"],function(k,f,o,a,j,c,g,m,i,n){return f([k],{cssRequirements:[{cssFile:"./css/HorizontalWidgets.css"}],templateString:o,baseClass:"horizontal-widgets",widgetWidth:null,widgetMarginLeft:null,widgetMarginRight:null,postCreate:function b(){this.doWidthProcessing(this.widgets);this.inherited(arguments);i(window,"resize",a.hitch(this,"onResize"))},doWidthProcessing:function l(x){if(x!=null){var w=g.getComputedStyle(this.domNode);var t=m.getMarginBox(this.domNode,w);var v=t.w;var y=0,z=0;if(this.widgetMarginLeft!=null&&!isNaN(this.widgetMarginLeft)){y=x.length*parseInt(this.widgetMarginLeft)}if(this.widgetMarginRight!=null&&!isNaN(this.widgetMarginLeft)){z=x.length*parseInt(this.widgetMarginRight)}var q=v-y-z;var p=0;var s=0;j.forEach(x,function(C,B){if(C.widthPx!=null&&!isNaN(C.widthPx)){p+=parseInt(C.widthPx);C.widthCalc=C.widthPx}else{if(C.widthPc!=null&&!isNaN(C.widthPc)){}else{s++}}});q=q-p;if(q<0){this.alfLog("warn","There is no horizontal space left for widgets requesting a percentage of available space",this)}var r=0;j.forEach(x,function(D,C){if(D.widthPc!=null&&!isNaN(D.widthPc)){var B=parseInt(D.widthPc);r+=B;if(B>100){this.alfLog("warn","A widget has requested more than 100% of available horizontal space",D,this)}D.widthCalc=q*(B/100)}},this);var A=0;if(r>100){this.alfLog("warn","Widgets have requested more than 100% of the available horizontal space",this)}else{A=100-r}var A=A/s,u=q*(A/100);j.forEach(x,function(C,B){if((C.widthPc!=null&&!isNaN(C.widthPc))||(C.widthPx!=null&&!isNaN(C.widthPx))){}else{C.widthCalc=u}})}},onResize:function d(){this.doWidthProcessing(this._processedWidgets);j.forEach(this._processedWidgets,function(q,p){if(q!=null&&q.domNode!=null&&q.widthCalc!=null&&q.widthCalc!=0){g.set(q.domNode.parentNode,"width",q.widthCalc+"px")}})},createWidgetDomNode:function e(u,q,p){var t=c.create("div",{className:"horizontal-widget"},this.containerNode);var s={marginLeft:this.widgetMarginLeft+"px",marginRight:this.widgetMarginRight+"px"};if(u.widthCalc!=0){s.width=u.widthCalc+"px"}g.set(t,s);var r=c.create("div",{},t);return r},createWidget:function h(r,s,u,p,q){var t=this.inherited(arguments);if(t!=null){if(r.widthPx!=null&&!isNaN(r.widthPx)){t.widthPx=r.widthPx}else{if(r.widthPc!=null&&!isNaN(r.widthPc)){t.widthPc=r.widthPc}else{}}}return t}})});