define(["alfresco/core/ProcessWidgets","alfresco/core/WidgetsProcessingFilterMixin","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","alfresco/core/CoreXhr","service/constants/Default","dojo/dom-construct","dojo/json","dojo/query","dojo/NodeList-manipulate"],function(k,m,h,j,b,c,d,f,g,l){return h([k,m,c],{quadds:null,postCreate:function e(){if(this.quadds!=null){var o=this.generateUuid();this._quaddsItemsHandle=this.alfSubscribe(o+"_SUCCESS",b.hitch(this,"processQuaddsItems"),true);this.alfPublish("ALF_GET_QUADDS_ITEMS",{responseTopic:o,quadds:this.quadds})}else{this.alfLog("warn","A QuaddsWidgets instance was configured that did not specify a QuADDS name",this)}},updatePage:function n(p,o){for(var s in p.cssMap){l("head").append('<link rel="stylesheet" type="text/css" href="'+appContext+p.cssMap[s]+'" media="'+s+'">')}for(var r in p.i18nMap){if(typeof window[p.i18nGlobalObject].messages.scope[r]=="undefined"){window[p.i18nGlobalObject].messages.scope[r]=p.i18nMap[r]}else{b.mixin(window[p.i18nGlobalObject].messages.scope[r],p.i18nMap[r])}}var t=this;var q=[];j.forEach(p.nonAmdDeps,function(v,u){q.push(d.URL_RESCONTEXT+v)});q.push(d.URL_RESCONTEXT+p.javaScript);require(q,function(){console.log("QuADDS requirements loaded")})},processQuaddsItems:function i(s){var p=[];j.forEach(s.items,b.hitch(this,"processQuaddsItem",p));var r={publishOnReady:[],services:[],widgets:p};r=g.stringify(r);var o=g.parse(r);var q={jsonContent:o,widgets:r};this.serviceXhr({url:d.URL_SERVICECONTEXT+"surf/dojo/xhr/dependencies",data:q,method:"POST",successCallback:this.updatePage,callbackScope:this});this.processWidgets(p,this.containerNode)},processQuaddsItem:function a(p,q,o){var r=b.getObject("data.widget",false,q);if(r!=null){p.push(r)}}})});