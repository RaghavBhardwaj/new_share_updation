define(["dojo/_base/declare","alfresco/core/CoreData","alfresco/core/PubSubLog","service/constants/Default","dojo/topic","alfresco/core/PubQueue","dojo/_base/array","dojo/_base/lang","dojox/uuid/generateRandomUuid","dojox/html/entities"],function(t,g,j,h,c,r,f,w,p,e){return t(null,{excludeFromPubSubLog:true,generateUuid:function k(){return p()},message:function q(x){if(typeof x!="string"){throw new Error("Missing or invalid argument: messageId")}var C=x;if(typeof Alfresco.messages.global==="object"){var A=Alfresco.messages.global[x];if(typeof A=="string"){C=A}}if(typeof Alfresco.messages.pageScope==="object"){var y=Alfresco.messages.pageScope[x];if(typeof y=="string"){C=y}}if(typeof Alfresco.messages.scope[Alfresco.messages.defaultScope]==="object"){var z=Alfresco.messages.scope[Alfresco.messages.defaultScope][x];if(typeof z=="string"){C=z}}f.forEach(this.constructor._meta.parents,function(G,E){if(G._meta&&G._meta.hidden&&G._meta.hidden.i18nScope&&Alfresco.messages.scope[G._meta.hidden.i18nScope]){var F=Alfresco.messages.scope[G._meta.hidden.i18nScope][x];if(typeof F=="string"){C=F}}});var D;if(typeof this.i18nScope!="undefined"&&typeof Alfresco.messages.scope[this.i18nScope]==="object"){var z=Alfresco.messages.scope[this.i18nScope][x];if(typeof z=="string"){C=z}}var B=[];if((arguments.length==2)&&(typeof arguments[1]=="object")){B=arguments[1]}else{B=Array.prototype.slice.call(arguments).slice(2)}if(B instanceof Array&&B.length>0){C=C.replace(/''/g,"'")}C=w.replace(C,B);return C},encodeHTML:function a(x){return e.encode(x)},dataScope:null,dataBindingCallbacks:null,alfProcessDataDotNotation:function o(x){var y=/(\.|\[)/g;return x.replace(y,"._alfValue$1")},alfSetData:function m(x,D,z){this.alfLog("log","Setting data",x,D,z,this);var A={};if(this.dataScope==null){this.dataScope=g.getSingleton().root}if(z==null){z=this.dataScope}x=this.alfProcessDataDotNotation(x);var C=w.getObject(x,false,z);if(C==null){}C=w.getObject(x,true,z);var y=C._alfValue;w.setObject(x+"._alfValue",D,z);if(C._alfCallbacks!=null){for(var B in C._alfCallbacks){if(typeof C._alfCallbacks[B]==="function"){C._alfCallbacks[B](x,y,D)}}}return A},alfGetData:function u(x,y){if(this.dataScope==null){this.dataScope=g.getSingleton().root}if(y==null){y=this.dataScope}x=this.alfProcessDataDotNotation(x);var z=w.getObject(x+"._alfValue",false,y);this.alfLog("log","Getting data",x,y,z,this);return z},alfBindDataListener:function s(x,y,C){if(x){this.alfLog("log","Binding data listener",x,y,C,this);if(this.dataScope==null){this.dataScope=g.getSingleton().root}if(y==null){y=this.dataScope}x=this.alfProcessDataDotNotation(x);var z=w.getObject(x+"._alfCallbacks",true,y);var A=this.generateUuid();z[A]=C;var B={scope:this.dataScope,dotNotation:x,callbackId:A};if(this.dataBindingCallbacks==null){this.dataBindingCallbacks=[]}this.dataBindingCallbacks.push(B);return B}},alfRemoveDataListener:function v(z){this.alfLog("log","Removing data binding",z);try{var x=w.getObject(z.dotNotation,false,z.scope);if(x!=null){delete x._alfCallbacks[z.callbackId]}}catch(y){this.alfLog("error","Could not delete data listener binding",z)}},pubSubScope:"",alfSubscriptions:null,alfPublish:function b(y,B,A,z){var x=y;if(A!=null&&A==true){}else{if(z!=null&&z==true){x=this.parentPubSubScope+y}else{x=this.pubSubScope+y}}if(B==null){B={}}B.alfTopic=x;r.getSingleton().publish(x,B,this)},alfSubscribe:function n(y,C,A,z){var x=y;if(A!=null&&A==true){}else{if(z!=null&&z==true){x=this.parentPubSubScope+y}else{x=this.pubSubScope+y}}if(h.DEBUG==true){j.getSingleton().sub(x,C,this)}var B=c.subscribe(x,C);if(this.alfSubscriptions==null){this.alfSubscriptions=[]}this.alfSubscriptions.push(B);return B},alfUnsubscribe:function i(x){if(x){if(h.DEBUG==true){j.getSingleton().unsub(x,this)}x.remove()}},destroy:function d(x){if(this.alfSubscriptions!=null){f.forEach(this.alfSubscriptions,function(z,y){if(typeof z.remove==="function"){z.remove()}})}if(this.dataBindingCallbacks!=null){f.forEach(this.dataBindingCallbacks,function(z,y){this.alfRemoveDataListener(z)},this)}if(this.servicesToDestroy!=null){f.forEach(this.servicesToDestroy,function(y,z){if(y!=null&&typeof y.destroy==="function"){y.destroy()}},this)}if(this.widgetsToDestroy!=null){f.forEach(this.widgetsToDestroy,function(z,y){if(z!=null&&typeof z.destroy==="function"){z.destroy()}},this)}if(typeof this.inherited==="function"){this.inherited(arguments)}},servicesToDestroy:null,widgetsToDestroy:null,alfLoggingTopic:"ALF_LOG_REQUEST",alfLog:function l(x,y){this.alfPublish(this.alfLoggingTopic,{callerName:arguments.callee.caller.name,severity:x,messageArgs:Array.prototype.slice.call(arguments,1)},true)}})});