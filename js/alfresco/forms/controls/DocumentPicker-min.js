define(["alfresco/forms/controls/BaseFormControl","alfresco/core/CoreWidgetProcessing","dojo/_base/declare","dojo/_base/lang"],function(j,c,g,d){return g([j,c],{getWidgetConfig:function e(){return{id:this.id+"_CONTROL",name:this.name,value:(this.value!=null)?this.value:null,options:(this.options!=null)?this.options:[]}},createFormControl:function k(m,n){this.alfSubscribe("ALF_ITEMS_SELECTED",d.hitch(this,"onItemsSelected"));this.setModelPickerWidgetValue([]);return this.processWidgets(this.widgetsForControl,this.domNode)},getValue:function b(){return d.getObject("widgetsForControl.0.config.widgets.1.config.widgets.0.config.value",false,this)},setValue:function i(m){this.setModelPickerWidgetValue(m)},setModelPickerWidgetValue:function f(m){d.setObject("widgetsForControl.0.config.widgets.1.config.widgets.0.config.value",m,this)},updateFormDialogButton:function h(n){var m=d.getObject("verticalWidgets.formDialogButton",false,this);if(m!=null){d.setObject("widgets.0.config.value",n,m)}else{this.alfLog("warn","The button to request a form does not exist",this)}},onItemsSelected:function a(n){var m=this.getPickedItemsWidget();if(m!=null){if(n.pickedItems!=null){m.currentData.items=n.pickedItems;m.renderView();this.updateFormDialogButton(n.pickedItems)}else{this.alfLog("warn","No items provided to assign to PickedItems widget, nothing will be set",n,this)}}else{this.alfLog("warn","PickedItems widget is not created, it is not possible to set items",this)}},getPickedItemsWidget:function l(){var m=d.getObject("verticalWidgets.pickedItemsWidget",false,this);return m},widgetsForControl:[{name:"alfresco/layout/VerticalWidgets",assignTo:"verticalWidgets",config:{widgets:[{name:"alfresco/pickers/PickedItems",assignTo:"pickedItemsWidget"},{name:"alfresco/buttons/AlfFormDialogButton",assignTo:"formDialogButton",config:{label:"Add",dialogTitle:"Select...",dialogConfirmationButtonTitle:"OK",dialogCancellationButtonTitle:"Cancel",formSubmissionTopic:"ALF_ITEMS_SELECTED",additionalCssClasses:"confirmationButton",widgets:[{name:"alfresco/pickers/Picker",config:{}}]}},{name:"alfresco/buttons/AlfButton",config:{label:"Remove All",additionalCssClasses:"cancelButton",publishTopic:"ALF_ITEMS_SELECTED",publishPayload:{pickedItems:[]}}}]}}]})});