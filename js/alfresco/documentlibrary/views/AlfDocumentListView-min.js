define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AlfDocumentListView.html","alfresco/documentlibrary/views/layouts/_MultiItemRendererMixin","alfresco/documentlibrary/_AlfDndDocumentUploadMixin","alfresco/documentlibrary/views/DocumentListRenderer","alfresco/core/Core","alfresco/core/JsNode","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/query","dijit/registry"],function(w,c,t,y,z,m,r,n,v,B,j,h,l,f,k){return w([c,t,z,n,m],{i18nRequirements:[{i18nFile:"./i18n/AlfDocumentListView.properties"}],cssRequirements:[{cssFile:"./css/AlfDocumentListView.css"}],templateString:y,widgets:null,noItemsMessage:null,subscribeToDocRequests:false,postCreate:function g(){this.inherited(arguments);l.add(this.domNode,(this.additionalCssClasses!=null?this.additionalCssClasses:""));if(this.noItemsMessage==null){this.noItemsMessage=this.message("doclistview.no.data.message")}else{this.noItemsMessage=this.message(this.noItemsMessage)}this.addUploadDragAndDrop(this.domNode);if(this.subscribeToDocRequests){this.alfSubscribe(this.filterChangeTopic,B.hitch(this,"onFilterChange"));this.alfSubscribe("ALF_RETRIEVE_DOCUMENTS_REQUEST_SUCCESS",B.hitch(this,"onDocumentsLoaded"))}if(this.currentData!=null){this.renderView(false)}this.alfSubscribe(this.clearDocDataTopic,B.hitch(this,"clearOldView"))},onDocumentsLoaded:function p(E){var C=B.getObject("response.items",false,E);if(C!=null){for(var D=0;D<C.length;D++){C[D].jsNode=new v(C[D].node)}this.setData(E.response);this.renderView(false)}else{this.alfLog("warn","Payload contained no 'response.items' attribute",E,this)}},onFilterChange:function s(C){if(C!=null&&C.filterId=="path"){this.addUploadDragAndDrop(this.domNode)}else{this.removeUploadDragAndDrop(this.domNode)}},viewSelectionConfig:{label:"Abstract",value:"Abstract"},getViewName:function u(){return this.viewSelectionConfig.value},getViewSelectionConfig:function d(){return this.viewSelectionConfig},getAdditionalControls:function o(){return[]},augmentData:function x(C){this.inherited(arguments);if(this.docListRenderer!=null){this.docListRenderer.augmentData(C)}},renderView:function i(D){if(this.currentData&&this.currentData.items&&this.currentData.items.length>0){try{if(D===false&&this.docListRenderer!=null){this.docListRenderer.destroy();this.docListRenderer=null}if(this.docListRenderer==null){this.docListRenderer=new r({id:this.id+"_ITEMS",widgets:this.widgets,currentData:this.currentData,pubSubScope:this.pubSubScope,parentPubSubScope:this.parentPubSubScope});this.docListRenderer.placeAt(this.tableNode,"last")}this.docListRenderer.renderData()}catch(C){this.alfLog("error","The following error occurred rendering the data",C,this);this.renderErrorDisplay()}}else{this.renderNoDataDisplay()}},clearOldView:function A(){if(this.docListRenderer!=null){this.docListRenderer.destroy();this.docListRenderer=null}if(this.messageNode!=null){h.destroy(this.messageNode)}f("tbody",this.tableNode).forEach(h.destroy);this.clearData()},destroyWidget:function b(D,C){if(typeof D.destroyRecursive==="function"){D.destroyRecursive()}},onViewShown:function q(){},renderNoDataDisplay:function a(){this.clearOldView();this.messageNode=h.create("div",{innerHTML:this.noItemsMessage},this.domNode)},renderErrorDisplay:function e(){this.clearOldView();this.messageNode=h.create("div",{innerHTML:this.message("doclistview.rendering.error.message")},this.domNode)}})});