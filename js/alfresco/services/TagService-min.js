define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","alfresco/services/_TagServiceTopics","dojo/_base/lang","service/constants/Default"],function(c,e,f,a,g,h){return c([e,f],{siteId:null,containerId:null,rootNode:null,constructor:function b(i){g.mixin(this,i);this.alfSubscribe(a.tagQueryTopic,g.hitch(this,"onTagQuery"))},onTagQuery:function d(k){if(k==null||typeof k.callback!=="function"||k.callbackScope==null){this.alfLog("warn","A request was made for site tag data, but one or more of the following attributes was not provided: 'callback', 'callbackScope':",k)}else{var m=(k.maxTags!=null)?k.maxTags:100;var l=new Date().getTime();var j=null;if(this.siteId!=null&&this.containerId!=null){j=h.PROXY_URI+"api/tagscopes/site/"+this.siteId+"/"+this.containerId+"/tags?d="+l+"&topN="+m}else{if(this.rootNode!=null){h.PROXY_URI+"collaboration/tagQuery?d="+l+"&m="+m+"&s=count&n="+encodeURIComponent(this.rootNode)}else{this.alfLog("warn","It is not possible to retrieve tags without a 'siteId' and 'containerId' or a 'rootNode' attribute set on the tag service",this)}}if(j!=null){var i={url:j,method:"GET",successCallback:k.callback,callbackScope:k.callbackScope};this.serviceXhr(i)}}}})});